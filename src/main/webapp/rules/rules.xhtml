<ui:composition template="/templates/pageTemplate.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">

	<div id="contentFrame">
		<ui:define name="contentFrame">

			<p:outputLabel value="Event rules" style="font-weight: bold; font-size: 24px;"/>

			<h:form id="resetButtonForm">
				<p:commandButton type="submit" value="Reset hits"
								 styleClass="ui-button-outlined"
								 style="width: 6rem; margin-left: 1rem; margin-right: 1rem;"
								 action="#{configBean.resetRulesCounterAction}"
								 update="resetButtonForm, rulesPanel" />
				<p:outputLabel value="Last reset: #{configBean.rulesLastResetTimestamp}" style="margin-left: 20px; font-size: 0.7em;" />
			</h:form>

			<p:accordionPanel id="rulesPanel"
							  multiple="true"
							  widgetVar="multiple"
							  activeIndex="-1"
							  value="#{configBean.rulesGroups}" var="group">
				<p:tab>

					<f:facet name="title">
						<p:outputLabel value="#{group.name}" class="boldtext" />
						<p:outputLabel value="#{group.endpoint}" style="margin-left: 20px; font-size: 0.7em;" />
					</f:facet>

					<h:form id="groupForm">

						<p:dataTable value="#{group.rules}" var="rule"
									 cellpadding="0" cellspacing="0">
							<p:column headerText="Rule name">
								<p:outputLabel value="#{rule.name}"/>
							</p:column>
							<p:column headerText="Filter">
								<p:outputLabel value="Host=#{rule.filter.get('host')}, Ident=#{rule.filter.get('ident')}"/>
							</p:column>
							<p:column headerText="Pattern">
								<p:outputLabel value="#{rule.pattern.get('type')}"/>
							</p:column>
							<p:column headerText="Action">
								<p:outputLabel value="#{rule.action.get('type')}"/>
							</p:column>
							<p:column headerText="Hits">
								<p:outputLabel value="#{rule.hits}"/>
							</p:column>
						</p:dataTable>

					</h:form>

					<br/>

				</p:tab>
			</p:accordionPanel>

		</ui:define>
	</div>

</ui:composition>

